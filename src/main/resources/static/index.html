<!DOCTYPE html>
<html lang="en">
<head>
    <title>Management System SPA</title>
    <script type="application/javascript">
        // Helper functions to clear and update the UI
        function clearTable(tableId) {
            document.getElementById(tableId).innerHTML = "";
        }

        function displayData(data, tableId, columns) {
            const tableBody = document.getElementById(tableId);
            data.forEach(item => {
                const row = tr(columns.map(column => td(item[column])));
                tableBody.appendChild(row);
            });
        }

        function displayEntityDetails(entity, detailId) {
            const detailElement = document.getElementById(detailId);
            detailElement.innerHTML = `${entity.name || ''} with details: ${JSON.stringify(entity)}`;
        }

        // General fetch functions
        function fetchAllEntities(entity) {
            return sendGET(`/${entity}`);
        }

        function fetchEntityById(entity, id) {
            return sendGET(`/${entity}/${id}`);
        }

        function addEntity(entity, data) {
            return sendPOST(`/${entity}`, data);
        }

        function updateEntity(entity, id, data) {
            return sendPUT(`/${entity}/${id}`, data);
        }

        function deleteEntity(entity, id) {
            return sendDELETE(`/${entity}/${id}`);
        }

        // Course Functions
        function displayAllCourses() {
            clearTable('coursesTableBody');
            fetchAllEntities('courses').then(response => {
                if (response.status === "success") {
                    displayData(response.data.courses, 'coursesTableBody', ['id', 'name', 'code', 'credits']);
                } else {
                    alert(response.message);
                }
            });
        }

        function displayCourse(id) {
            fetchEntityById('courses', id).then(response => {
                if (response.status === "success") {
                    displayEntityDetails(response.data.course, 'courseDetail');
                } else {
                    alert(response.message);
                }
            });
        }

        function addNewCourse() {
            const course = buildCourseFromForm();
            addEntity('courses', course).then(response => {
                if (response.status === "success") {
                    displayAllCourses();
                } else {
                    alert(response.message);
                }
            });
        }

        function buildCourseFromForm() {
            return {
                name: document.getElementById("newCourseName").value,
                code: document.getElementById("newCourseCode").value,
                credits: document.getElementById("newCourseCredits").value
            };
        }

        // Professor Functions
        function displayAllProfessors() {
            clearTable('professorsTableBody');
            fetchAllEntities('professors').then(response => {
                if (response.status === "success") {
                    displayData(response.data.professors, 'professorsTableBody', ['id', 'name', 'email', 'phone']);
                } else {
                    alert(response.message);
                }
            });
        }

        function displayProfessor(id) {
            fetchEntityById('professors', id).then(response => {
                if (response.status === "success") {
                    displayEntityDetails(response.data.professor, 'professorDetail');
                } else {
                    alert(response.message);
                }
            });
        }

        function addNewProfessor() {
            const professor = buildProfessorFromForm();
            addEntity('professors', professor).then(response => {
                if (response.status === "success") {
                    displayAllProfessors();
                } else {
                    alert(response.message);
                }
            });
        }

        function buildProfessorFromForm() {
            return {
                name: document.getElementById("newProfessorName").value,
                email: document.getElementById("newProfessorEmail").value,
                phone: document.getElementById("newProfessorPhone").value
            };
        }

        // Room Functions
        function displayAllRooms() {
            clearTable('roomsTableBody');
            fetchAllEntities('rooms').then(response => {
                if (response.status === "success") {
                    displayData(response.data.rooms, 'roomsTableBody', ['id', 'number', 'capacity', 'type']);
                } else {
                    alert(response.message);
                }
            });
        }

        function displayRoom(id) {
            fetchEntityById('rooms', id).then(response => {
                if (response.status === "success") {
                    displayEntityDetails(response.data.room, 'roomDetail');
                } else {
                    alert(response.message);
                }
            });
        }

        function addNewRoom() {
            const room = buildRoomFromForm();
            addEntity('rooms', room).then(response => {
                if (response.status === "success") {
                    displayAllRooms();
                } else {
                    alert(response.message);
                }
            });
        }

        function buildRoomFromForm() {
            return {
                number: document.getElementById("newRoomNumber").value,
                capacity: document.getElementById("newRoomCapacity").value,
                type: document.getElementById("newRoomType").value
            };
        }

        // Department Functions
        function displayAllDepartments() {
            clearTable('departmentsTableBody');
            fetchAllEntities('departments').then(response => {
                if (response.status === "success") {
                    displayData(response.data.departments, 'departmentsTableBody', ['id', 'name', 'code']);
                } else {
                    alert(response.message);
                }
            });
        }

        function displayDepartment(id) {
            fetchEntityById('departments', id).then(response => {
                if (response.status === "success") {
                    displayEntityDetails(response.data.department, 'departmentDetail');
                } else {
                    alert(response.message);
                }
            });
        }

        function addNewDepartment() {
            const department = buildDepartmentFromForm();
            addEntity('departments', department).then(response => {
                if (response.status === "success") {
                    displayAllDepartments();
                } else {
                    alert(response.message);
                }
            });
        }

        function buildDepartmentFromForm() {
            return {
                name: document.getElementById("newDepartmentName").value,
                code: document.getElementById("newDepartmentCode").value
            };
        }

        // Time Slot Functions
        function displayAllTimeSlots() {
            clearTable('timeSlotsTableBody');
            fetchAllEntities('timeSlots').then(response => {
                if (response.status === "success") {
                    displayData(response.data.timeSlots, 'timeSlotsTableBody', ['id', 'day', 'startTime', 'endTime']);
                } else {
                    alert(response.message);
                }
            });
        }

        function displayTimeSlot(id) {
            fetchEntityById('timeSlots', id).then(response => {
                if (response.status === "success") {
                    displayEntityDetails(response.data.timeSlot, 'timeSlotDetail');
                } else {
                    alert(response.message);
                }
            });
        }

        function addNewTimeSlot() {
            const timeSlot = buildTimeSlotFromForm();
            addEntity('timeSlots', timeSlot).then(response => {
                if (response.status === "success") {
                    displayAllTimeSlots();
                } else {
                    alert(response.message);
                }
            });
        }

        function buildTimeSlotFromForm() {
            return {
                day: document.getElementById("newTimeSlotDay").value,
                startTime: document.getElementById("newTimeSlotStartTime").value,
                endTime: document.getElementById("newTimeSlotEndTime").value
            };
        }

        // HTTP Request Functions
        function sendGET(url) {
            return fetch(url, {headers: {'Accept': 'application/json'}})
                .then(response => response.json());
        }

        function sendPOST(url, data) {
            return fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            }).then(response => response.json());
        }

        function sendPUT(url, data) {
            return fetch(url, {
                method: 'PUT',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            }).then(response => response.json());
        }

        function sendDELETE(url) {
            return fetch(url, {method: "DELETE"})
                .then(response => response.json());
        }

        // Utility functions for creating HTML elements
        function tr(children) {
            const node = document.createElement("tr");
            children.forEach(child => node.appendChild(child));
            return node;
        }

        function td(content) {
            const node = document.createElement("td");
            if (content instanceof Element) {
                node.appendChild(content);
            } else {
                node.appendChild(document.createTextNode(content));
            }
            return node;
        }
    </script>
</head>
<body>
<h1>Management System</h1>

<!-- Courses -->
<h2>Courses</h2>
<form action="javascript:displayAllCourses()">
    <span>View all courses</span>
    <input type="submit" value="Go">
</form>
<form action="javascript:addNewCourse()">
    <span>Create new course with</span>
    <label for="newCourseName">Name</label>
    <input type="text" id="newCourseName" name="newCourseName">
    <label for="newCourseCode">Code</label>
    <input type="text" id="newCourseCode" name="newCourseCode">
    <label for="newCourseCredits">Credits</label>
    <input type="number" id="newCourseCredits" name="newCourseCredits">
    <input type="submit" value="Add Course">
</form>
<div id="courseDetail">Course details will appear here.</div>
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Code</th>
        <th>Credits</th>
        <th></th>
    </tr>
    </thead>
    <tbody id="coursesTableBody"></tbody>
</table>

<!-- Professors -->
<h2>Professors</h2>
<form action="javascript:displayAllProfessors()">
    <span>View all professors</span>
    <input type="submit" value="Go">
</form>
<form action="javascript:addNewProfessor()">
    <span>Create new professor with</span>
    <label for="newProfessorName">Name</label>
    <input type="text" id="newProfessorName" name="newProfessorName">
    <label for="newProfessorEmail">Email</label>
    <input type="email" id="newProfessorEmail" name="newProfessorEmail">
    <label for="newProfessorPhone">Phone</label>
    <input type="tel" id="newProfessorPhone" name="newProfessorPhone">
    <input type="submit" value="Add Professor">
</form>
<div id="professorDetail">Professor details will appear here.</div>
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th></th>
    </tr>
    </thead>
    <tbody id="professorsTableBody"></tbody>
</table>

<!-- Rooms -->
<h2>Rooms</h2>
<form action="javascript:displayAllRooms()">
    <span>View all rooms</span>
    <input type="submit" value="Go">
</form>
<form action="javascript:addNewRoom()">
    <span>Create new room with</span>
    <label for="newRoomNumber">Number</label>
    <input type="text" id="newRoomNumber" name="newRoomNumber">
    <label for="newRoomCapacity">Capacity</label>
    <input type="number" id="newRoomCapacity" name="newRoomCapacity">
    <label for="newRoomType">Type</label>
    <input type="text" id="newRoomType" name="newRoomType">
    <input type="submit" value="Add Room">
</form>
<div id="roomDetail">Room details will appear here.</div>
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Number</th>
        <th>Capacity</th>
        <th>Type</th>
        <th></th>
    </tr>
    </thead>
    <tbody id="roomsTableBody"></tbody>
</table>

<!-- Departments -->
<h2>Departments</h2>
<form action="javascript:displayAllDepartments()">
    <span>View all departments</span>
    <input type="submit" value="Go">
</form>
<form action="javascript:addNewDepartment()">
    <span>Create new department with</span>
    <label for="newDepartmentName">Name</label>
    <input type="text" id="newDepartmentName" name="newDepartmentName">
    <label for="newDepartmentCode">Code</label>
    <input type="text" id="newDepartmentCode" name="newDepartmentCode">
    <input type="submit" value="Add Department">
</form>
<div id="departmentDetail">Department details will appear here.</div>
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Code</th>
        <th></th>
    </tr>
    </thead>
    <tbody id="departmentsTableBody"></tbody>
</table>

<!-- Time Slots -->
<h2>Time Slots</h2>
<form action="javascript:displayAllTimeSlots()">
    <span>View all time slots</span>
    <input type="submit" value="Go">
</form>
<form action="javascript:addNewTimeSlot()">
    <span>Create new time slot with</span>
    <label for="newTimeSlotDay">Day</label>
    <input type="text" id="newTimeSlotDay" name="newTimeSlotDay">
    <label for="newTimeSlotStartTime">Start Time</label>
    <input type="time" id="newTimeSlotStartTime" name="newTimeSlotStartTime">
    <label for="newTimeSlotEndTime">End Time</label>
    <input type="time" id="newTimeSlotEndTime" name="newTimeSlotEndTime">
    <input type="submit" value="Add Time Slot">
</form>
<div id="timeSlotDetail">Time slot details will appear here.</div>
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Day</th>
        <th>Start Time</th>
        <th>End Time</th>
        <th></th>
    </tr>
    </thead>
    <tbody id="timeSlotsTableBody"></tbody>
</table>

</body>
</html>
